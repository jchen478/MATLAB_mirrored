clc;
clear;
close all;
format long

%% Simulation Paramters
nL3 = 152.77;
% kb = [0.051 0.51 1.09 ...
%     2.34 5.056 ...
%     10.88 23.44 ...
%     50.56 108.81 ...
%     234.43 505.6]; 
% 
% eta = [0 0.036183 0.071983...
%     0.089372  0.110706...
%     0.155243 0.300016 ...
%      0 1.13166 ...
%      0 3.304143 ]; 
 
kb = [0.51 1.09 ...
    2.34 5.056 ...
    10.88 23.44 ...
   50.56 108.81 ...
     234.43 505.6];

eta = [0.036183 0.071983...
    0.089372  0.110706...
    0.155243 0.300016 ...
   0.738924  1.13166 ...
   3.187212  3.304143 ];
 
 I = [0.004743 0.004638 ...
     0.004794 0.005053...
     0.005346 0.005829]; 
 
nseg = 20;
rps = 10;
Seff = pi*kb/nseg^4; 
over_Seff = 1./Seff;
Lbox = 930;
L = 2*rps*nseg;
nbin = 36; 
nbinh = nbin/2; 

%% data
% eta = [0.036183 0.071983 0.089372 ...
%     0.110706 0.155243 0.300016]; 
ncase = length(eta);

%% plotting
color = {rgb('Crimson'),rgb('MediumBlue'),rgb('DarkOliveGreen')};

figure()
scatter(over_Seff,ones(length(kb),1),...
    50,'MarkerEdgeColor', color{2},...
    'Marker','x',...
    'Linewidth',2)
    set(gca,'xscale','log','yscale','log')
figure()
plot(over_Seff(1:ncase),eta(1:ncase),'-.o',...
    'MarkerSize',10,'MarkerEdgeColor',...
    color{2},'Linewidth',2.5,'color',color{2})
ylabel('\eta_{sp}')
set(gca,'xscale','log','yscale','log')
% figure()
% plot(over_Seff(1:ncase),10^3*I(1:ncase),'-.o',...
%     'MarkerSize',10,'MarkerEdgeColor',...
%     color{2},'Linewidth',2.5,'color',color{2})
% ylabel('\it{}I (\times10^3)')
% set(gca,'xscale','log')

%% figure formatting
tickx = 2;
for i=1:2
    
    figure(i)
    hold on;
    box on;    
    set(gca,'fontsize',24,'linewidth',2,'fontname','Times New Roman')
    set(gca,'YMinorTick','on','XMinorTick','on')
    set(gca,'ticklength',tickx*get(gca,'ticklength'))
    set(gcf, 'color','white')
    set(gcf,'PaperUnits','centimeters','PaperPosition',[0 0 30 20])
  
    xlabel('1/S_{eff}')
end

%% fit
% [p] = polyfit(over_Seff(1:ncase),eta(1:ncase),3);
% 
% fit =  over_Seff(1:ncase).^3*p(1) + ...
%   over_Seff(1:ncase).^2*p(2) + ...
%    over_Seff(1:ncase).^1*p(3) + ...
%    over_Seff(1:ncase).^0*p(4); 
% 
% figure(2)
% hold on
% plot(over_Seff(1:ncase),fit(1:ncase),'-.o',...
%     'MarkerSize',10,'MarkerEdgeColor',...
%     color{1},'Linewidth',2.5,'color',color{1})
% 
